[event]
	name=prestart

	{SET_GLOBAL_MODE}
	[store_unit_type]
		type=CompanyScout,CompanyStandard
		variable=GN_COMPANY_TYPES
	[/store_unit_type]

	{VARIABLE GN_COMPANY_TYPES_LEAST_EXPENSIVE 0}

	{VARIABLE GN_COMPANY_INDEX 0}

	[store_side]
		side=1-10
	[/store_side]

	{FOREACH side i}
		# multiply every gold parameter by GN_GOLD_FACTOR
		[modify_side]
			side=$side[$i|].side
			income="$($side[$i|].income| * $GN_GOLD_FACTOR|)"
			gold="$($side[$i|].gold| * $GN_GOLD_FACTOR|)"
			village_gold="$(2 * $side[$i|].village_gold| * $GN_GOLD_FACTOR|)"
#			village_support="$($side[$i|].village_support| * $GN_GOLD_FACTOR|)"
		[/modify_side]
	{NEXT i}

	# replace each unit with a standard company with that unit as leader
	[store_unit]
		[filter]
			[not]
				race=Company
			[/not]
		[/filter]
		variable=allunits
	[/store_unit]
	{FOREACH allunits i}
		{CREATE_COMPANY CompanyStandard allunits[$i|] (
			name=$allunits[$i|].name|+_"'s Company"
			unrenamable=$allunits[$i|].unrenamable
			canrecruit=$allunits[$i|].canrecruit
			upkeep=$allunits[$i|].upkeep
			overlays=$allunits[$i|].overlays
			role=$allunits[$i|].role
		)}
	{NEXT i}

	[modify_unit]
		[filter]
			race=Company
		[/filter]
		experience=60
	[/modify_unit]

	{CLEAR_VARIABLE allunits}
[/event]

